<div class="container">
  <div class="form-container">
    <!-- Encabezado -->
    <div class="header">
      <h1 class="title">Actualizar Mis Datos</h1>
      <p class="subtitle">Modifica tu información personal</p>
    </div>

    <!-- Loading -->
    <div *ngIf="isLoading" class="loading-container">
      <div class="loading-spinner"></div>
      <p>Cargando información...</p>
    </div>

    <!-- Contenido del formulario -->
    <div *ngIf="!isLoading">
      <!-- Mensaje de éxito -->
      <div *ngIf="submitSuccess" class="alert alert-success">
        <div class="alert-icon">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="20,6 9,17 4,12"></polyline>
          </svg>
        </div>
        <div class="alert-content">
          <h4>¡Datos actualizados exitosamente!</h4>
          <p>Tu información ha sido actualizada correctamente. Serás redirigido al inicio en unos segundos.</p>
        </div>
      </div>

      <!-- Mensaje de error -->
      <div *ngIf="submitError" class="alert alert-error">
        <div class="alert-icon">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"></circle>
            <line x1="15" y1="9" x2="9" y2="15"></line>
            <line x1="9" y1="9" x2="15" y2="15"></line>
          </svg>
        </div>
        <div class="alert-content">
          <h4>Error al actualizar datos</h4>
          <p>{{ submitError }}</p>
        </div>
      </div>

      <!-- Formulario -->
      <form [formGroup]="userForm" (ngSubmit)="onSubmit()" class="user-form">
        
        <!-- Información Personal -->
        <div class="form-section">
          <h3 class="section-title">Información Personal</h3>
          
          <div class="form-row">
            <div class="form-group">
              <label for="nombres">Nombres *</label>
              <input 
                type="text" 
                id="nombres" 
                formControlName="nombres"
                [class.error]="formErrors.nombres"
                placeholder="Ingresa los nombres">
              <div *ngIf="formErrors.nombres" class="error-message">
                {{ formErrors.nombres }}
              </div>
            </div>

            <div class="form-group">
              <label for="apellidos">Apellidos *</label>
              <input 
                type="text" 
                id="apellidos" 
                formControlName="apellidos"
                [class.error]="formErrors.apellidos"
                placeholder="Ingresa los apellidos">
              <div *ngIf="formErrors.apellidos" class="error-message">
                {{ formErrors.apellidos }}
              </div>
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="cui">CUI (DPI)</label>
              <input 
                type="text" 
                id="cui" 
                formControlName="cui"
                class="disabled-field"
                readonly
                title="El CUI no se puede modificar">
              <small class="field-note">Este campo no se puede modificar</small>
            </div>

            <div class="form-group">
              <label for="fecha_nacimiento">Fecha de Nacimiento *</label>
              <input 
                type="date" 
                id="fecha_nacimiento" 
                formControlName="fecha_nacimiento"
                [class.error]="formErrors.fecha_nacimiento">
              <div *ngIf="formErrors.fecha_nacimiento" class="error-message">
                {{ formErrors.fecha_nacimiento }}
              </div>
            </div>
          </div>
        </div>

        <!-- Información de Contacto -->
        <div class="form-section">
          <h3 class="section-title">Información de Contacto</h3>
          
          <div class="form-row">
            <div class="form-group">
              <label for="email">Correo Electrónico</label>
              <input 
                type="email" 
                id="email" 
                formControlName="email"
                class="disabled-field"
                readonly
                title="El email no se puede modificar">
              <small class="field-note">Este campo no se puede modificar</small>
            </div>

            <div class="form-group">
              <label for="telefono">Teléfono</label>
              <input 
                type="tel" 
                id="telefono" 
                formControlName="telefono"
                [class.error]="formErrors.telefono"
                placeholder="12345678">
              <div *ngIf="formErrors.telefono" class="error-message">
                {{ formErrors.telefono }}
              </div>
            </div>
          </div>

          <div class="form-row">
            <div class="form-group full-width">
              <label for="direccion">Dirección</label>
              <textarea 
                id="direccion" 
                formControlName="direccion"
                placeholder="Ingresa la dirección completa"
                rows="3"></textarea>
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="ocupacion">Ocupación</label>
              <input 
                type="text" 
                id="ocupacion" 
                formControlName="ocupacion"
                placeholder="Profesión u ocupación">
            </div>
          </div>
        </div>

        <!-- Información adicional -->
        <div class="info-box">
          <div class="info-icon">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"></circle>
              <line x1="12" y1="16" x2="12" y2="12"></line>
              <line x1="12" y1="8" x2="12.01" y2="8"></line>
            </svg>
          </div>
          <div class="info-content">
            <p><strong>Nota:</strong> Los campos de CUI, correo electrónico y contraseña no se pueden modificar por razones de seguridad.</p>
            <p>Si necesitas cambiar tu contraseña, contacta al administrador del sistema.</p>
          </div>
        </div>

        <!-- Botones -->
        <div class="form-actions">
          <button 
            type="button" 
            class="btn btn-secondary"
            (click)="onCancel()"
            [disabled]="isSubmitting">
            Cancelar
          </button>

          <button 
            type="button" 
            class="btn btn-outline"
            (click)="resetForm()"
            [disabled]="isSubmitting">
            Restaurar
          </button>
          
          <button 
            type="submit" 
            class="btn btn-primary"
            [disabled]="userForm.invalid || isSubmitting">
            <span *ngIf="isSubmitting" class="loading-spinner"></span>
            {{ isSubmitting ? 'Actualizando...' : 'Actualizar Datos' }}
          </button>
        </div>

        <!-- Información adicional -->
        <div class="form-footer">
          <p class="form-note">
            Los campos marcados con * son obligatorios.
          </p>
        </div>
      </form>
    </div>
  </div>
</div>
